board = '''####################################################################################################
##......[]..........[]..[]..[]##....[]..........##..[][][]....[]##..........[]....[]##....[]##....##
##..[]..##..[]##..................##[]....[]....##[]......[]....[]##............[]....[]..........##
##......[]....[]......[][]....[]##....[][]##..[]..............................................[]..##
####........##[][]........[]..[]##..[][]##..[][][][][]......##[][]..[][]........##[]........##....##
##[]......##..[]......######..[][][]......[]..[][]....##........[][][][]##[]..[]..............[]..##
##[][][][]....[]##[]..[]..[]....[][][]....[]........[]............##[][]..[]....[]....[]..........##
##........##[]..[]........[][]..............[]......[][]....[]..[]..[]....[]............[][]##[]####
##........[][]................##[]......##..[]........[]..[][]......[]..[][][]..................####
##..##[][][][]....[]..[]............[]....[]......[][][]........[][]..##[][]..##..................##
####[][]............[]..[][]....##......[][]..[]####..[]........[][]....[]..........##............##
##[]....[]..####[]........[]......####..[]........[]....##....[]......[]..[]................[]....##
##[]............##..........[]..[][]....[]............[]......##......[]........[]..[]....[][]....##
##......[]....[][]..[][]..........[]##[][]..........[]....[][]..##..........[][]....[]....####....##
##..##..[]##..[]....[]..............................[]....[]............##........##........[]....##
##[]......[]........[]..........[]........[]......##....####..##............[]....[]......####....##
##....[]..[][]..........[]..####[][]..[][][]....[]............[]..[]..[]......[]....[]..[]..[]....##
##......####....[]....[]..[]..................[][]..[]..##..[]..[]......[]......[][]............[]##
####......[]##..............[][]..[]........####........####[]..[][]..[][]..[]........##..........##
##..[]..[][]##......[][][][]##....[]....[]....##....[][]....[]............[]....[]........##[]..[]##
##....[]................[][][][]##[][]..[][]......................[]..[]....[][]........[][]......##
##....[][]..[][]##..[][]......[]................##....[]....[]....##[][]##..........[]....[]......##
##[]........[]....[][][][][]......[]..##......[]..##..##..[]..................[][][]##..[]......[]##
##[]........[][][]..[]......[]..[][]............[]..[]##..[]..[]....##[]....[]##..[][][]....[]..[]##
##[]................[]..[][]......##......[]....@.............[]..[]....##[]....[][]..[]..##....[]##
##[][]........##..[]............[][][]....[]..............[][]........[]##..[][][][]..[]..........##
##..[]..[]..[]......[][][]....[]..[][][]..[]##..[]##[]......[][][]##....##..............[][]..##..##
##..[]....##..[][]....##..##......[]..................[]........[]....[]..........[]..[][]..[]..[]##
##..[]##[][]..[]....[]##........[]............[]......[]##..[]....[]..[][]..[]......##[]........####
##....[]..[][]....[]..##....................##..[]........[][][][][]##[][]..........[][][][]..##..##
##..[]....[]..................[]####[]........[]..##..##............[][]..........[]....##..[]##..##
##..##....[]##..##......##......[]..........[]....##..........[][][]....[]##..[]....[]####[]......##
##..[]##....[]......[][]....[]......[]..##....[]..[]........[]....[][]....[]..............[]....[]##
##......[]..[][]......[]........[]..............##[]..[]..[]####..[]......[]....[]##......[][]..[]##
##........[]..[][]......[]........[]......[]........##..##....##....[]......##..[]..[]..##........##
##..[][]..##..##....[][]##........[]..[]....##....##....[]..[]....[]............[]....[]..[]......##
##....[]......[]##..[]......[][]........[][]......[]..##....[]......##..........##......[]##[]..####
####....[]....[]..##..[]......[]....[]....[]....##..............[]....[]....[]##....[]..[]......[]##
####........[]......[]..[]....[][]............[]......[]..[][]....##..[]##....................[][]##
##[]......[]....[]##[]......[][]......[][]..[]..........[]......[]..##........[]..[]....[]....[]..##
##........[]......[]..[][]........##[]..[]......##..##............[]..##......[]......##......##..##
##..........[]....[]..[]......[][][]##[]....##[][]..[]......[]......[]....[][][]......[]......[]..##
##[]##[]........[]##........[]..##....[][][]........[][]......##......##............##....[]..[]..##
##[][]....##..........##..[]......[][]......[]##..[]..[]..[]....##........##[]..[]..........##....##
##......[]........##[]..[]..[]....##....[][]......##..[][]........##....##..[]............[]......##
##[]........[][]....[][]..[][][][]......[][]........[]..........[]......##....[][]..##..##........##
##[]........[]....................[][][]..[]....[][]..[]....[]....##....[]##....[][]....[]......[]##
##..[]..[][]....[]........[]........##[]##[]............##......[]######......##[]........[]....[]##
##..##[]..........[]....[]......##[]..........##[]................[]..[][]........[]..##........####
####################################################################################################'''

commands = '''<<>^><>v^v<<<v<>>>vv>v><>>v^>><>v>>><><<^^<v^^>v^><<^><<v<>^v>v>><v>>^v<<<v><<<<vv>^>>v^v>>v>>^v>v>vv><>^<><<>v>v>^>>^<^v<^>v<<><^>^^>^<^><<^><v^><^><v>v><<v><>^<<v<<<<<^^<>>>>>>v^^^>>^v<v>>><^>v<^<^v^>><vvvv>^><vv<v<>vv<^v^v<vvvv^>>v<^^vv^>vv^<>>^<v<><^v^<>^vvvv>>v>^<<v>vv><<<>v^v>^<<<v<v>>vvv^>vv>><<>v>v<<<<^v<>v>vv><>^<vv<<<<^<^>^v^v^v>v^>>v^v<<v^^>vv>^>><<><<>>^><>v>^>^^^>^v>>^^v^<v><>vv>v<>v><^<^v<<vv>>^^^<v^^^^^<<^v<^vv^>v><<^^^<^v<^v^v<v>vv^^>v<><>v^<<v>^><vv>vv<<<^^vvv<v>vvv^^^>>^v<<vv<><^<^<vv>^v<vv^v<<^^^<v>v^^v><><><^<^><v>v>><>^^>^<<v^<^v<v><<v><>^<<^<>^>v>^><<v^>>v^^><v><^>v<^<v<^>v<<^<<^>^>v^><vv>vv^v>><>^^^<>>^<^^vv<<<<^>^>^^^>v<vv<^v>>^v^^<^>^<^<<>v^>^>v>>>v<v<^v>v><<^<^vv>^><v<vv>^^^<<<v>vv><><^^<>v>><>^><^>^v^><^vv>><vv^v>^<^vv^<^<v><<v>v^>^^^<<<><>vv><v^<><^>^<^<<<>^v><vv>^>v^v<><vv>v>^><>>^><><^^v<<<<vv<>^vv<^^v^><>vv^^^<>>vv>>><<><v>>^>v>>><>v^<^<^^><v><vvv^>v<^v<>v^><^>^^^<^^v<^>^<><>vv>v<^v<v<>^^^v^>>vvvv>><>^>vv>v<v<v^v^>>v<>^v><v^^v<<v^v>><^>>>vv<<>>^vv^v>vv^<>
>^<<v>>v^<>^^<<^<^>>v^>v^^v>>><>^<<^><v>>^>vv<>v<>^<>^v<v><<<<<v^^>^>v<v^^^<<<^<^<<<<>>v<^v^v<<><v^>>^>^^<^<<^^^v^>>^v^>><>^<^<><v^>^^^vv<^^v<>v>v>v<^<v<v>^v^^><>>>^><^v<vv<>v<><vvv<<^<<vv<^>^<v<<>>vv^<>>v><^<>v^<<v>^<>><>><<>>^<^^<>^v<^^>>>^><v<vv>>^vv<v^>vv^>^^<^v>>^^>^>^^^vv^^>><<v^<>>^^<vv^><v<vv<><<v>>^^^v^<<^>v>^<^vvv>v^^^>><<^v^<^v>v^vv^^vv<v^><vv^>^><><^>v^><<<><^v<vv<>^vv<v><>^^><<<^><<>><>>^v>v><<><^<<<v<>^v>>^<<^v<>><^v>^>^<vv<^^v><v>v><<^vvv<>>v<^^>^>>><v<><<>vvv^^v^<v<v<>vvv^^<>>>vv><^>>vv<>v>v>>>^^<<<>^v^^^^^vv><v>^v^v^><v>^vv>vvvv^^^>><^^v<^><^><vv><<v^><<>>v>>v><^>^>v^>v<^>v^^>^>>>vv^><>v<<><<^v<^<>v>^^<<^<<^^^^^^<><>><^vv>vv><>^<^>v>^vvv^<v>v^>^vv<^>>^^^^<v<^^<>>^vv<<<^v<vv>v^^<><><<<><v<v<v^v>vv>vv>^^>><<>>>>>><<v<<<<vv>v<v^^v^>v^<>v<>v^>^^v<^v>>^>^<^>>>^<<<<v<vv^^>>^v<>^><<><^<>v^^^<><<^<<>>vvv^v>>>><<v<>^>>^<>>>vv^<v^v<^>^v>vv><<v<v<<<<v>^vvvv^v^<v>vv>>vv<^v<<v^<vv<<><v>^><v<^>^<^>><<><><<>v>><><>^^^<><^v<v<>>^v<<^v^v>vv<^^vvv<>v><v<^<<>^v^v>>v<<>^^<vvv<^^<><>>>^v>v
>^v^v^<^v>><<<^vv<>><>^<>^<<<^<^^v<<v<v<v<>>><^<vv<>^v<><<<>>^<>v^^><<<^<<<^>vvv<^<<<<<<<><>^<v>v^^vv<><>^>>v^v>^<vv^vvv>v^^<^^^<v^^<^^<<vv>^^v<<<<<vvv>v<>^v^<<^^><>v<<<^v^>vv><>v>^v>v^^v^<<<>v<vv><>>><>>><^<v>v>>v>^>v^<><v^<>^^vv^^^<>^v>^v<v^v><<v<<v<>>v<v^v<v<<v^v><<^>>^^v>>^>^>><v>v^^^v>><><vv>>v^>>>v<>^><<><>>>v^<<^><>><v><^><v<^>vvv^vv<<>v<>v><>>vv<v>^v<<^v^>v<v^<<<^v<v>vv>>^v>^>^<><<v^>v^vv>^vv^^v^><<>>><>v^>><v^^<^>v^^v>v^v<<>v>v>><^^^v<^v^>^<vv^>>^><<>^vv^^v<^>><^v<^<<<><vv^<><v>^<v^v<<>>>>>v<<v<<^<>>^<v^^<vv^><><v>>vv<^^><>v<^vvv<<<^^^>^v><v<v>^^<v<v<vvvv>vv>><>^<>>>^><v>^<<v<v<<<^<<^>v<>>>^vvv<v^v<>^^v>vvv<^v>v^^v>v>vvv><<^<vv><v^>vv^v>><>v^v><^<^v^v<^v^<><<<v<^^><v>^><^<vv^v<<><^>^^^>vv>^vvv><<>><^<>>>^<^><^>^vv<><^>><><><>^><>^v>>v^^>vvv>v<><<v<<<>v^<vv>><v>><>>>v>^>^^^v><^<^v<^<^<^v^<v^^<<<v<<v<^>v>^v>><v^<v^<v<<v<<>^>^<vv>v>v^v<<^v^><^>>>^^^<>><^^><^v><><v^vvv>v^v>>v<^^><^vv><<^v>^v^^<^vv>v<v<<vv><>^<v<<v<<<^^^v<<>><^<<>>>>^^^^^<v>v<<v>><<><<>><v^v^>v>>>^v>>>^^^<^^>>^><^<
v<vv<^>v<v<><v^<>^^<vv><<<^<<<>^^>>><^^<v^v<^<>v<>v<^^^v<^^v<<v<v^<><^^<>v>v<>v>v^^><<<^^v^<^vv<>>v^>^<v<>vvv>><v>^>v<v^<^><<^>v^^^^<>^>>>^^><<<v^^>^>v>v>^<vv>v^v>^<>^^<v<<^v>^<<<>v<<>v^<<><<>vv^v>>>>v<>^v><>^v>v<^<>v^<^>v<><>^<^vv>^><>^v<^>><vv^<^<v>^v^<>>vv^><<^^><^<^v^>><v>^>v<v^v^>>>>>><^><v^<v<<<^<^<^v><<<<>v^<^>^<v>^^^<^<<v>vvv^^^v><<v>><<><^^>^v>v^<vvvvv>>>^>v>>>^<><^v^v^<^^^v^<vv^>vv><<v<^v^<v><^^<^<^v>>v<v^<vvv^>^>v>v<<^>^^^>^<^><>^v<^><>v<>>v^v<^vv^>v^vv^<<^<<<<^>^>>>^vvv>>vv>^>>v>^vv><<>vvv^^<^^>^<><^v><<^^v^<^<^v<^vv<><v>>>^>^><>v^>vv^^>^vvv>>>v>>vv<<<<v<^>^^^>^><>^^>v^<<^^>v^vv>v>^>>^^^^vv<^vv<<>><^v<vvv><<>v^>^^<<vv<<<<<^v<<>>^v^<>v^<<v><>v^v^v<>v^^^<v^vvvv^<<>^vv<><<>^>>>^>^^>^^^^^v>^^^^^^v>^v<v>^v<v>v^^>^<><^<v<>^>><>^<<<v<v>vv><^><^<<><v>>^^v^vvv<>>^>v>^^v<^v<v><^v<>^vv<<^v><v^v^v<<^^^>v>vv<<>>>>v<>vv<^<v^^v^<vv>^^>v>^>^^>vvv>^<v><^><<v^v<v>>^^^<^v<<<^vv>^<v<>><><^<<^^vv>>^<<^^v^<<^>^<vv<^v<^>>>v<^^>v^^>v^>>^vv^^>v<<v^>^<><<<v<^^><^vv>><v^^<^^<<vvvvv^>^><<^>^<<>>>^vv><
^<^<^<^^vv><^><<<v^^v<<>>>^v><v>><<<<<>>v^>^^v<^^>^<<v<>^v<vv^^<vv^v>>^><<v<>vvv>v>v<<vvv<>^<>^><^v<>^^^><v<<^<^<v>^^>^^v<^>vv><^^<>v^>v>^^>v^>v>>v>^>vv>v^<<<<v<<v^<>v>v<>>v<^^<<^>^v<<>v>><>v^v<>^^<<v^<v<vv^><^>vv^^>v<v^<^><<^vv<>v<>v<^^><^^v^^<^>^v^>>v^v^<<vvv^^<vv>v>v^>^<>^<<^v><>^v<vvv^<v><v<<^v<^v<^<><><v<^^^^v>^^>v^^^<>><^<>^^>^<<<^^<^>^>^v>>>v^vv><<<^<^v>vv<^<v><^^><v<>v<<v<<>v>>>>>^v>v<>^vvvvv><^^^>v^>>v^^<^^>^<>^^^^<>^<>^<v^v<<^>>v>v^v^^<v<<v^^^<v>v<>^^><v>>^vv^<<^>>>^^vv>^<>vvv<<>>^><>><<v^^<^<>v>vv^<^<><<v^^v<<<>v<<<vv^^^<>>^<>v>v>>v^>v>><>vv>>^^^<v><>^^^v^<<><^vv^><>^>v<^><^>>v^^<>v^v^v^^v>vv>>^^v^^v^v<<>^<><^^v>v><<<<>v^^v>^^<><^^^vvv^<v^vvv><>v>>^^^v^^>^><v<><^><>>>^<v^^v<^<<<vv<<v^v<<vvv^>^<v^>>>^<>vv>><vv^v>v<>vvv><>>vvvv>v<<<^^>v<v>^^>>>><v^v<>>v<v^v><^<v>vv^><<^vv>><<vv<>^^<v<>^v><>vvv^v<^^><^^v<>^<<^^^<v<>v<^>v^^<><<v<>>v^>>>^<^^>vv^v^<>v<>>vvv^>^<v><>v^^v^<v<>v^>>v^v<<^>><><^>^<>^v^^vv<><v>><^^v^v^<^>>^><^v<^>vv^<>v>^>v<<>v<<^>^<<<>v><<<^^>^><v><v^<<><<<v^>>v^><<<v<>
v<<<<><<>v^<>v^^><><>v<vv>^v<vvvvvv^^>v^v><>^^<<v<vvv>vvv^^v<^>vv^<v<vv<<>vvv<<v<^^><vvv>^^<^<>>^^><<<>><^<vv<><<vvvv^^^<<<<<^>vv<<^>v^>^v<^>^<>>^v^v>^<v^v>>v>>v<v><<>^>^<v<<><^vv>v>^><^^>><^^vvv<><>vvv^<v<v>^>^^<vv<<^vv<^^><>^v^<^<v><^^>v>^v>v^>v^><v<>>^v><v>vv<^>>v^^v^^<>^v>v>^<<><^<>^<^^>>^^>v^v^>>v>^>v^>v<^<>>>vvv>><v<^v<^vvv>>>^v^>>^vv<v<<v><^<>>>^>vvv>><^vv<<<>^>^v<<^^<^^^<>v<v>^><^<^<^><><v<v^v<>>^>^<<<<v<^^<>>>vv<<^<^v>^<<>>>vv^v^^><<vv<<vv<<^^><<>>>><vv<v><v>><^<v>^<<vv<v^<>v><v<>>v<<v^>^<<>^<vv^>>v><v^v>^^^v>>^>>>v^vv>>v<vv<v<>>^>>><^<>>v>v><<v<v<>v^>v>>vv<<^>v^><^v>v^>>>><>^>vv^^^^v<^^<<^>^^>^><><v<<<>v^<v<^v^>^>^^vv<<<><v^v^v<<^vv<<^><<vv>><vv>^vv^<v>^^v<>>^vv>^>v^v>>>>vv>><^v^^^vv^^v<>><>^v>^<v<>v>v^v<<^><>v<<>^><^vv>>>>^<><^<<v<vvv<<>^><v>^vv^^<>v>v<^><><^vvv<^^<>v^>^<^^v^v><<^>^v^v<v><<v>^<>>><>vvv^^v<^>>vv<v<>^^v>^>v^^>><>>>^>><<><<>><^<^v<v><>^^v<><v><<^vvv^<>vv^>><>^<^^v^v>v^>v<<>v<<^^>>v<<v<^v><<^^<^>>>^<>v<><>^<<v^v>vv>^<<^v^><><v^>v<^>><^><>vvv<>vv^^^<><v>><<v<>^<v
vvv>>v^^v>v^^<><v^vvvv<>v^^v<><v^>^v>v^^v^>v^>^<>>><>>>vv>v<v^v>^vvv<<>^>>v^vv<vvvv<^v<^<<>><v^v<><<<^v>^>v^<>^^v><<v<><vv>>v<vvvv>vvvv^^>^><v<v<^^vv<v^^>^><vv<>vv<>^v^^v^<<<^^^^<><vv<<^^<^>>v<^vv>><v<>^v>v^v^^>^v<><^v><>>^^v<><>^>><^^>^>v^><v<^>>^v<>>>vvv^^^<^v^>>^<>^vvv^>>^<^^<><^v^>>>v<<^>^>^^v<vvv<>v^v^^v>v^^<<<>><<^vv^^<>><>^^^v>^v^vvv^>><v<^^>^vv<^vv^<<<v>>vv^<^v^<^^><<v^^^<^<>>>^<^v><>v<^<<>vv<>^<v<^>vv>v>^>^^v<<<^>^v>^<><v<^^^>>>>^v>><^^>^<><^<><<vv^>>^^^^>^>^v<<<^v<v^><>^>>vv^v<>v<^v><>^v^v<^><>>>^v><>>^vv^^>v^<vv^^<>^<^>^<>>v>^>^<v>>>vv>><^>>^v>>>^<vv>v>^<^v>><v^<v<v^>v^^<^>>><^v>>v>v>^<^^<<>v^v<<v^v<v^vv^<^^>>>^v<>>vv><v<vvv<>v^><>>^>vv>^>>^v^>vvv<^^<v<><v>>^^<<<^<^>v^><>>^>^v^vvv<<^>^<v><>>>>><v^vv><>>^<v^>vvv><<v>v^<>vvv>>><<^^^><<^vv^v><<><vvv^<><^^>^<>vv<<v^>^>>^<^^<<<>><^><^<^<>>v>vvv<><><^>^><v^v>v>^v<>>^<v<vvv^^v>>>><>vvv^^^vvv<>v>>>>v>>^>>^v^v<<<^^vv^^v<>^<>>v<v<<>^>v<>><>^<^^^<v>^><^vv>v^^^><v^<vvvv^<v<v<^><vvvv>>>>v<vvv^<vvv<>v>^^<>v<<<v><<^^^<<^^v>^>^<^>^<><^^<>>v
^<v<v<<^><>>vv>^<<>>>^^>v>v^^>vv^>><^<>^vv<>v<v^><vv<>>vv<v>^^<^><>^<v>v>vv^>v^^>>v>>^^<^<<><v<>v><>><^>><>v^^<v>^v^>^<v^^<>v>>^vv>vvvv<<<^<v<^<>>^>>><^><<<v>v><>^>vv<^v^v^^v><<^vv^<v^>>><>^^<^<^<vv<<<vv><<>v<^<>>^vv><^><vv^>^^^>^v>vv^v>v<<><^^<^<><^<>v><<>><v^><v<<<<<<vv^vvv^^v<<<>v<^>><>^vv>>>><vv^v>^v<^vv>>>><><^<<^v<^<^><<>vv<>^vv^vvv<^>v^v^<v>>^v>>>>v^^vv<<>>^^<^<>>vvv<>v^v<<v><<v^<<>vvv^><vvv><>^v^v^>vv>v><^vv^^v<<v<^^>>^<>v^>v<v>^^v>^><v>^>v>>><>^><vv<v>^v>vv<>v<^^>^v<v>^>^><v^^^^<<vv>>v>^^^>><^v<><v>^<<<v^^>v>>><v>v^^<^<<<vv>>^^v<><<v<<<><^^^<vvv^v>>^^<<^^v<><^v>^>>^<<vv<>^<<^^v^vv^^><^><<>v^^<^v><><^^><><^><^>vv>^^vv^><<^<>^^vv^<v^^v^><>^v^v<>v^<^v^>^<>v<^^<^<^<^vv^^<<>^^^<<<>vv><>v>^v^v^<v^^v<^>^><>v<v>>^<<^^^<v>>^<v^>>^vv^<v<<><^vv^<v^vv^v>^^<><^<>><^v<v>>>>vv<>vv<>v^>v>>^^vvv<^<^><^v<>v^v<^>>v^<<>><^>>v^<^^<<<>vvv^^v^^>>><v<v^^<v^v<<vvv^<>>vv<v>v>^>v^<vv>v<^<>v<><v<v<>v><^>v>^<^>>><<<<vv>v<vvv<<>>^^>v>><v<vvv^^<v^>^v>^v^>v<v^>^v<v^><><^>>^<^><^<>^>^<^^^^<<<^vvv><>v>>^<>>^^^
^<v<^^<><v>>^>>v<^<<^>>v<<v^>>^<^>v^v>>v<>vv<^vv^v<<v^^><<>v><^^<vv><>><<><v<><v>>^v^><v^>^>>^vv^v^^>^>v^>>v<<>^vvv<>v^<<^<<^>^<vv^<<<v>^<>>><^<^>v>v><v<<<v>>>>>v^>^<><<>v^^vv<<<>v^v^><<^>vv<>>^><^^<^>^^><<<>v^<v^>^<v^v<<v^<>>^^^><><^<<>^v<vvvv>^v^>^>>>^v>>^v>^^^<v^vv^^<^>v<v<v>>^><<<^>^<^<<v>^^^v^<^<^<v><<>><<<<v^<^v>^vv^<>^^<><>v>>v>^>vv<^><vv^<^v<<<<v><>^v>vv^>>v<<v^>v^<vvv^><<^v>vv<^v^<>v^v^^^v^<<v<><v>vv^v^>^<vv<<vv><^v^^v^^><v><^vv^>>><>>v^^^<v^^^^<>^<^<>v><^>^v^^v^v<^vv^>^<<^v^v^^v<^v^<^^><>v><v><^v^>v>^><vv<^v><v<^v>^^<^v<^<v^<vv^vv<<<<^<v<>>^>v>vv>v<^^>^v<v>><<v^<><^^>v<>^^>^<<<<vv>v><^><<<vv><<^v<><<^v^^>>^<v>^<<v<<<>^v<^>v^^<^<^<<>^v<><v<vv^^^v<^^>^v<vv^v>^<vv^<>^<<v>>vvv<><><v<<>v^vv<<<<>v^^v><^vv<^>^>v<>vv<vv^><^v^>v><v<>>v<^vvv^<vv<v>v>>v>><>>v^>vv><<>>vv^^v>v^v^v<>><>>^vv>v^vv^>^>vv><^^v^^>>>^v<^<<v>v<>^^<v<v><>>^^<>><<<<vv<vv^^><vv<^>v^<^>^v<<v<>^<v>^^v^v<^^v^<><vv^^<v^^>^^^>v^<v<v>v^<v^^<>v><>^<v^<v^v<v>v><<^>v^^vv><>>>v<v^v<><<<v^^<v>v<^^<<<<v>^vv<>><v^v>>^>v<vv>>^<>^
^v^<>><^v<<>>^^<<^<>>>v<<^<>v><^^v><^v>v^v^v<>>v>>v>^v^v>^>>><<<^^>^>v>>^><<^>^^<>vv<<v<v^vv>>>>>^<<><<vv><v^^><v^v><<^^>^^<^v<^<<v>^<<v^>v^>>^<v^>^<>^^v<><<^>>v<^v<vv<>v<<>^vv<v^<vv>>>vv<^<>><v^>v>v^v<v^^v^>v>>>>^>>^v^v<>>vv<^^>^^^^<v>^^vv^vv<^<vvv>>v<^><^>v>>>>><<>v<v>>><>^>>><>v>>>>>^<^>^<^<>^vv<<^<<<<>^<<<^<^^<>>>^<<^><^<<<v>^^^^v><><<<>^<<<v><^>>v<><v<<v<vv<^v^v>v>^^<v>v><^<v><^>v><<<><v^><<^v^>><vvv^<>v<v><<<v^^^vvvvv>^<vv>^<><^v<<<>v<>v>vv^v>^v<^>vv^><>^v<^v<<v^v^vv^v^vv<^v>>vv^<v>>vv<<^v^v<^v^<^>>vv^>vv><v<^>^>>^<v<^v>vv<>>v^<^>v><<^<vv>><>^>^>^>v>^^<^v<><v^^v<<<v<>>^^>^>^><vvv><>>>><v<^^>v^>v<v^<><v<v>v^v<^^<^>>^<^<>^^>vv>vvv>^<>>v^v^vv<^^<<vv^^^^><v^>><^<<v<v^vv<><><<^v^v<>>^<^vvvv^>^v<>><<<><^^vv<<<^<<v<v^>v^^>v^v>^<>>>^>v>>^v^^^v<v^><>>>^^v^^v^<>>^>vv<>^><v^<<<><<^^<^<<^v^v^v>^>^<<v><>^<^^v^><<><^v^><vv>>v>^>^>>><>v^>><^v<<<<<^v>^^^^v^v^vv^^>^^>vv^<^<v>>^<>v<^>><>v<v^v<vv^>^^v<^^<v^>v>^<<>^>^<<v<vvv><^^v<<<>^^^v><>vvv^^<^<>^>v><>v>><^<>>^>^vv<><vvv^^v><v<>>^>vv>>v^<^<><vv^v
<<>>v>^^<<<vv>v><<<<v^v<<<<^v><<<vv^vv^^^v^><^vvv>^<<^><>v>><<<^v^^>>^v>v<>>><v^v^v>>^^v>vv^v>v^<^<vv<v>vv<^^^><^v>><>>>^<v^^^v<^^>^<>^^^<>vv^<>><<<v^^v<^v^v>v<^^^<>v^>vv^<<^v<<<<<<>v>>>><<<^<v^<<vv^>vv<^><<>^>>>>v<v^>^>>^v>vv^v^v^<v>v>v>>>v<<>v><><<^^>>>^vvv^^^<v^v^><^v^<<<^^^^^^<<v^<>^v^>v<vv>><vv>v<><>v>^>v<>vv^>^<>v<<<vv<^>^v^<^>^v^<^>^v<<>^vv^><>vv><<<^>>^^^^>^<>>v<<>vv>v><<><>><>^>^>^v^<^><<^v^>>^<v<<<>^<<>><^>v>^<<<<^<^^v^><>>v^^>^<<<<<v^^<><>^v^^v<>>^^^<<<v>v^><v^^<<<^>>v>vv^v^>>>vv>>v^<<^v<<^<><^vv>^>^^vvvv^<v<^<<v<^><^^<^<vv<<<^^vv^^^<<^^<>v<>>^^^v<^<^^<v><<<v^>^v>^<<vv^^^^v^<<^^<^^<<<<<v>^^<^^>>v<>vv><<<vvv<>^^<<><><^^<v^>>^><>v>vv<<><^vv<>v>v<v>^^v>><v><<v<^>><>^><^<<<>>v<><<^v<^<>>>^^v<^vvvv<<>v<<<^<>^^<<^>vv<><>>v<><^vv<^<^<v><<vv<^v<v<>^<<<v><^^<^<><<>>v<^vvv^^<><<^<<>^>>vv<^v>vv^<^^v>>v><^v<>v>v^v<<<<<<<vv^^^<vvv<v^<><<><><^>^>v^>v^^v<v>vvv>^>v<^v<>v<<^^^^<^<>^^^<v^^>v<v^v>v^<^v><>><><^^vvv><^v<^^v^>^vvvv<>^<><<<><>>vv^>>^^^><><<v><^>v^><>^^^^v^<^<<<><<>^v<^v>v<<>>v<v^v
v<^>><^v^>v<v<v^<^^vvv<v>><>v^<>v<^<v^>v<^^<^v>>^^^<><^<^^^^^<<>><><>v^vv^<>v^><v^^^vvv>^v^<v^v>><>>v>>v^<v^v^>^vv^v<v>>v<><><><^<^^v^^>v^>>>^>^<^<^v>vvv<^>><>>>^>>vv>^^vv^>v<<><<^>v<>>><<><v^^<^^v>^<<<<v><v^^<vv^<^>>^<<v^v^vvvvv>>^<^<^>>>>^<><^<>vv<vvv<>>>>>v<^^vv<v^<v^><>^^^>^<v<<^vv<v^<^<v<v>^><<<^<v>vvvv<<^<<<><>v>>>>^vvv><^><^<^>^<v><^<><<v>>^>v<>v<^^<<^^^<<<><^<v^^<<^^><<v>>vv>^^v<>>^>>v>vv<<><<^^>>^<<v>><<>^<v><v<^<^<^<^><^v<^><^><<^>^vv^v^>>v<^><<^>>>^><^>>^^v>^>v<<^^^<^vv^v<<>>^>><v<>>>vvv>vv^v<<^v<^^v<<vvv<>>^<^<vv<^<^<^>>vv<>v^>>v^<>><v<<><vv<<>>>v<^<^><^v<v<<>v<><vvv<^<^<<><>><v^><^^<>><>^vv>v^^<>v^<^^^^^^vv>>^vv^v>vv<<>><<^v^v<v^^^v<<<<<><<<<v<v>>^><^><v<>v>^^vv^^><^v^v>><^>>vv><>>^^v^^<v>^<<^>>v<v>^<^^^<>^v^v<<^v^^^>>v<>v^>^>>v<^v>v^v^^<>^v<<>>v><^^^vvv>v<<<><v^<<^^^^>v<>><^vv^<>><>^vv><>>vv^>v^<v>v<^<^^^><>v<<<>v>>v^>vv^v>>^<<><><v>>>^<<^>v^v<<>^v^<<<<v^<^>><<^v><^v><vv>><v^v>>^vv><>^^^>><<^^v><vv<<^^<^vv>><>v<<<^v<<>>v<<vv<>v><v^^vv>^<^vv><v^<>^<v<v<<<<vvvvv>><vv^v<v<<<
^<^<vv<>^>v^<<<v>vvv^vv^>^^><><>v<v><<^^<v^<><^^^>^^^><v^vv>^v>v>>v^^v><<v^^><>>>>><><>>^>^^>vvv<<><<^v<v^v^v>vv<>^<>>^<vvv<>^><<^v^^<><v>v>>^vv^^<^^>v>>>v<<^v>^<>v>v^vv<>v>>^<v><v<>^^>>^<vv<>^v^^v^>v>v>^<v>>><v<>v^<^v<v>>v<v<^v<>^<>^<<<>vv>vvv<>>>>vvvvv><<>>^^^v><v<v^<^><^v<vv<><^>^>^^^>v>>v^<>v<^<v^^v><<v^>>>^^^<<^vv>>^<<^^<v>^<>>>vv<<<v^v<>vv<<>v<vvvv>vv<><vvv^v^v<^v>^vv<>>vv<>><>>v<^^<<^^v>v^^>^vv>v<<vv>^>^<<<vvvv>>^^<<v^^<vv>><^<<^><v<vv<><<>>v<vvv>v><<>v>>>v>^v^>><<<<>><<<>^><^>^^<<^^<<>>^vv<><>>^<>v<<<>>v<><<>><v^<<^vv<><v^^><>>><><^^^^<>v>v<vv^<>v^v^^<v<>>v<>><<<>v>><^<>^^>^^>>^<^v^>>^^^>^v<<v<^vv>v<vv><><><>^vv<>v<<<^><v<^>v>vv^^v<>v>v^><^v<^>v>><>>^>vv<><v><vv>^>><><<>><vv<^>>^v>>><<>>v<<v<^^<v<>v><<<<>>>v>vv^v^v^vv>>>>vv>^<><>>v<>^<<^>v>^>>><v><^><><<>><>v><<>^>v<^v>>^^><v<<<<<<vvv^><>^<<<<v>vv><^>>^^vv^^v<<>^>><v^<<>v>vv^^>>^><<<v>vvv>>><v><>>vv^>>><<v>>><v^vv><^vv<>^^^^><<<<^vv<<v>^v<<><v<>^<<<vv>>^><v<^v>^v>>>v<>v><<>vv^<^^^v^v^><>v<>>vvvv<<>^^<vv>^><v<^^^^<>>^v>>vv<vv^>v
^<>>^^^<<^>^>>^v^^>>>><^<>>v<>^>v<<<vv^^<<><^><^^<vv^>^^>v<^^v<<v<v^vv<<v<v>^><^<^v^<^v<^v^<^v<<>v^>>v>vv<<^vv^v><<v<v>><><v<v<v>v>><<^<<v>><^^^^vv^vvv>><>>v^^<>v<<<v^^^^><v<<<<>^^v^^vvvv<>^^v<<v<<^^>v^^<^><^>^<^vv<^v^v^>v^><>v^v<<>^<^>v>>v>>^v^^^v><>>>>>v<<<v>>v<>v<^<>v^^v<vv<<<^<^><<>^>vv^<<>v^^vv>>^>>>vv<vvv<>>^v^^<^>>vv>v^v^><<^><v>^vvv<v>^v>^vv^v><^^^<<^<<^^^<<>^<>^v^^<^^^^>>><vv<>>vvv>v^<v>>^<><vv><^v>>>v^<<v^>>>v^>>>><^v<v^^>><v^<^vv<v><<^^v^>>>^<><<><>>^<^>^>^<^<^v^vvv>>vv^v<^v^v>^<v>>>>^v^<>v<^^^>^^^>^<^>^>^>^vv^v<vv^^v^>^>>v^>v<v^^^^v^><v><^v^v><vv>v>^vv<vvv<<>v>^vv^>v><^^>vv>v><<^>v^vvvvv><>^^v^^>v<v<^v><<v<^>^<><v>v><vvv^^<v<v<v>v^^v^<>vv<v^<v^^<^^vvv>>^^>><vvv>v^^^vv<^>v^><<v^vvv^<v>vvv<>v^<v>^vvv<>^>vv^<^v<^^><<<<<>v>^v>^<^vvv<v>^<>>>^<<<^>v>^vv^<v<v>>v^<<<^^v^<><v>^vv>^^^>vv<v>v^<<<^>vvv^v><v^<<^<>^<^>>vv>v^^<v>vv^><<v<^<^<<^<^^^<v^>^v><<^v><<^><><<<><>>v>^<><vv^^>^<<<>^^v^><v^v<<<^^>vv<<v><^<<<><v>^^v^v^<<<><^<^^>v^^><>^<^^^>^^<><>^>>vv>vv>v^^<>>v^<>^^<^^^><^vv^>><>^><v
><<^v<v<^v>^>^^v<<<^v>^<>v>^^><^<v>^^v>vv<v>^>v>><<v^^>^^<<<><>><><>v^<>^^<<>^vv>>^^^<v<<>^^^^v<^<^<^><^<^^><^>v^><^>^>>^>>^^v>><<v>^<<^v><vv>>^^v<>>vvv^<^v^^<^^<>v><<^vv<v<v<^>^v>vv><^<>v>^^>vv>v>^^^>v<<v><^v^>^>>^>v<<<vv<v<v^<^>>^<^v>>v<<<vv^v>><vv<v>^<^^>v<v>v>vvv^^<><>v<^>^v^v>vv<^<^v><<><v>>v^^^^^vv^^<^><>>v^><^>>^<<^>^^>^<^v<v^><v<<^>>vv>>v>>^v><>vv^v>v<v>>v^<>vv><>v^^^>^^<<^<v<<v<vv>^>>vv>^<^^>^<<v<><<>^<<^<<^v^>>^>v><><^vv>>vv^v>>^v<vv<^<v>v^v<vv>>v^<vv<vv>>^<v><>^v<^>><^<<v>^^^v^v>^^<^^>><^<>v^<^<v>>^vvv<v<v<^<<^<>><v>v>v<^<v^>^<>^^^v>><v<>^^v><>>^<<^><v^<<>v>^>>^>v>>^><v><><<^v<<^v<<<><<v>^v>^>>v>>v><><><<v><^v<^<v^vv>^<vv^>>v<<vv<v^^>v^^v>^v><<<^>^<><><<^<v><>v^<<<>^>^>v>v>vv<v^^<^^^v<v>^<vvv<v<>^v<^^<<<^^>v<>vv<^^^><<>^^<v<v^^^v^vvv<^v^>^><v<<<^>v>^>v>v<^vvvv>^><<vv^<<<<^v<v<vvv^><v>^<>^<<<<v<><v>vv>^vvv<<<>^<^v>vvvv<>vv<>^<<>v<<vvv<>v>^<>^v^<^<v><vv<^><^^>>vv>>v>vvvvvvv<^<v<>v>>>>>>^^^vv><v^v<<<^v^^vv<v><v<^v<<v<>>>^<^^>><<>^<><^vv><><><^<^v^<^><v^<^>><><^^>v>>^>vv^v<>><^v
<v<><<>><v>>v<<^<>><>v<>vv^^vvv<^v>>>><v^><>>vv^^<vvvv><<><v>^^<^>^><^^<^>^^v^^^^>><>v><<<<v<>vv><<vv<vv><v<v<^<^v>v<>v^>>><^<^v<><^v<v>v>>^<^>^<^^>^v<<>v>^v>vv^<v^>v^<vv^<v^v<vv^vvvv<<>><^^vvv^v^<^v<<<<v^<>^v<v>v^<v><<>v>^v<>v^v<vv>v<>v<<><<>v^^^<v<^<v^v^<v^>^>^><<><<^v>^vv<<<>vv^<<^<>^^^v^^<v^v^v<^<>^>v<><<>^v^<<^v<<^<^^vv^v>v>^><>v^>^>><v<^<vv<^<<>v^v>>>v>>^^v<^<vvv<<v>^<<v<<^^><v<v^<^<vvvv<<v>^<^^v<>vv><^^^>v^vv<>^^^<^>>v<>^v^^<v<>>v<<<^<>^v<v<^<>>v>><<^<^v^<<><><^v^^v<^^^v<v>^^^vv<<^vv<<v>>^vvv>v^>v<>^^<<<>v<v<<^vv>v>^>v^<^^^>^^^^>^>>>vv>>v<v>^<v^^<>>vv><^^>>^^>><^^v<^<^<<^<^>^v<^v<>^<>^>v<vv<v^v<<>>vv<^v<^>^><<><v^><^<>^>>>>v^^<>>>^v<v^><<><>>>>^^^>v<^v><v^^<>v>>>v<^v^<>v^><<^>vvv>>^<^<>^<^v^>^^<vv<>v>^<><<v><>^v>>>v<^v><v^>^><<<v^<<v><>^><^^><vvv>>><v^^v><<v<^>^>^><^>v<>^^>vv<^<>>><^^v^>^vv<<><v>^v>v>>>>vv>v>v<v<><>>>v^^<<>><^^><><><v<<>^><^>^vvv^><>>>v><<v<^>^vv^^v<vv>>vv>v<^^<>>^><>>><v<<<vv^vv^^^><<v>>vv^<<^<>v<^<vv>>v<>>^<>^>^<>v><^^^^vv><<^<<vv>vv^>^^>vvvv>v><>^<<>><<<>^>v^
^^^<<>v<<^^<^^>^<v>v^<^^>^v<<^>>v><^v><<<><>^v<^v>^v<>>>vvvvv>v^^<<>^>>>>>>>vv>>v><>v>vv>v<>v^vv^v^>v><<<^^<^v^v^<^<^^^^><><>>>v><><^vvv<^>vv^^<><<v^^vv^<v><^>vvv^<<<^<<<<<<>^>><>^>vv^>v^<>vv<><<^<<<>><>v>v^^v^^<>^v^<<>><^v<<>><^v>^>v^>v^^vv>>v<>^<^<^>>^>vvv>v^<vv>>v<>>v<^<v>^<^<v<v<^>><<^v<>v^>>><^vv>vv>vv>^>^<>><<v><v^>>>>v<>^<^<><^^^v><<<v><<<<>^<^v<^vvv^<^v^^>^>>v>^><v<vvvv<>^v^vv>v<<v<>>^>^^vv<<<^v<^<<<<v^v><>>><v^^>^v^^^>>vv<>^<<>v<v^>^v><<><><v<v^^<vv<<>^>>><^^v><^>^><><<v^^<vv^<<v^v<<<>^^<^>>v<<>><<<<<v<v^^^<v><^^v>>^>>>^<v><v>>vvv>^^>vv^^^^<<><<^><<<><vv<<v^>>vv>>^vv^^<^^^>>^>v>><vv^><^>^<>^><<><><vvv><^^>^^<vv>v<^>v>v>>>>^<^^^<<<v<v^v^><^^^^v^<^v<<>^v>>^<>vv>v^^<<v><>>>^^v>^<v^vv^<v<>^v<>v^><v<^v^>v^^<^vv^^^^<^<^vv^<^<^^<>^v>^<<^v>^v<<<>^v<^v><^><v^>^v<<vv^^>^<v<^^v><vv>v^vv^^v>v^>vv<<^v>v>><^v<^^<v<>^>^<<<<>^<>v<<<<^^<<^<^v>^vvv><>><vvv>^<^^v^v^><><><v<vvv^v<<v<^vv^>v<^^<<>v<<>^><><<v^<>><>>v<>^<^^<v^>^><vvv^^>^^><<<<>^^^<<v<^v><v>>^v<v>>>><^^>v<vv<<v^v^<<<<<v^>><vv^v><<^>>v
^><vv^vv^^vv>v>^v^v^^<>^v<^>v>^>vvvv>vv<v<>>><>>^^<v<<^<vv<^>v>v>^>>>^<<^><^>>>>vvv<v^>^^<^^v<>^>>^vvv^^>^v>>vvv<^^<^><>>^>>v^v><<>v>>^>^v>>^<^^vv><<^v^>>>^^^^>>vv><v<<^^<v>^^>^<<^>><>><^>>vvv<^<^<v>^<>^>vv^><<>^<<v^<<^v^v<v^^<v<^^^><^v<v>vv^^>^^vv^v<>^^v^v<>>>^vv>v>>^^v<^v^^>><vvv<>v>>^v^v>^><v<^^^^><<>^<^><>v>v>>^v^^^v^^<<v>^<<>^<><<^<^>v<<<^^^>v<>v^vv^v<^v^^<>v<^<>vv<><<>v<v^>>vv<<vv>^^^<<<v<vv^<>^v<v<vv<<<v^<^v>>^<<v><v<>^v^^>>v^<v><^v<^^><^v<>^>v^^v<vv^><><vvv<vv>v><^>^<>v^<>v<^>>><v^<^<><<^<^^>>v^^v>^^^^^<>>^v^^>v<><>vv<^<v>>v>vv^^^<<^v<>v<^^^><<v<^v><<<><<>vv<<v^^v><v<>v>^v^>>>v^<>v<vv>vvv<v><>>><<>v^<^<v<<>>><<^vv<><v>>^>^<<<<v^>>>^^>^v>>v<^<^^>^<v<v><<<^v><vv^>^>^vvvv>^>v>^v^<<>v^v<<<v>>^^>^><>^<>v^>>vv^^>^><vv>v^<^<<<^^<>>>>><^>^^><><^>^^<v<>><>>^v>><<>>>><^<<<^vv>>>^<v<^^v^v^<><>>^^>^^>><v>>>><v>>v^v^v<<v<v>>v<>^v^>>>v^<<<^<><><^<v<^>>>^>v>^vv^>v<v<v>^<>^<vv^<v^><<v^^>^^v><<v>v>v>^vv^vv><^<v^>v<^^<vv>v<vvv^>^v><^<>v><<<^^v>>^^vv<^^<v<^>^^<^vvv^<>^^vvv>vv^^v><v<<^^v<<v^<<><>>
^v>>^v><vv><>^v^^><^^v<>v^^^>^^<<>^v<^<v<^>>v^vv^<^v^<v^^<v^>^>v>>^<v<v>vv<vvv^<<>><<vv><>^<>v^vv^v^^^<v<vv^^><v>^<v^v>^<<>^^vvv^<v><^v^^<<^>^^<v>v<v<^<<>vv><^><>v>>><><<<><v^^^><v^<v<<<><^>vv<<<^v<<>><>^>>>>><v>>^<v<^<v^>>^<>>>v>><^^v<><<><vv<^<^^>><^>^vv<<<v<<^><^><<^^v^^^^<^v><v>><vv<<v>v>^^>^^>>v>^^vv>v<^^^<v^<<<^v^^>vv<^^<^>vvv>^<v^>^^vv<<v^<<>v^>vvvv>^v>><^>v<vv>^>><^^^<vv<>v^^>^^>^v<><<<^>>vvvvv<<<<v>>v^><>^^v><<v><v^v^^v><v^<<^v^<^>v<v<<<<>vv>^^<^<<^<>^><^<v<^v^>^>>v>v^>><v<><>^^vv<^><v^<<<^v^^>v<>>^>>>v<>^^v>v<<v>^^<^^v<<>vvv<v<>><^vv^v>>v^^<v>^v^vv<v^>vv^^<v<>^<><<<>>v^v>^<<vvv>^^><^>v><>v^^^^><^<>^v^^>><v^^v^^v<^<^^^v^vv>^v^vv^v^^v^^<^<^^^><^>v<vv<><>^^>v<^^^v<<<^^vvv<v>v^<^<<<v^<>>>^<>vv<>v^<>^^^v<>vv<^><v^<^>^^^<v<<>^<<v^><<<<v>v><v^>v>^v<vvvv<^<<vv<^<>^^<vvvvv^<<^<vvv><vv<^^v<<><^<>><v<>v>v><vv>>v><v>^<v>>><<<^^>><v^^^vv><^v<v><<vv^vv^vv<^>^><>>v^^<>>>>v>vv^<v<>^v>v>^>^>v<<>v^v>vv^^>v^v><<^>>v><>v>>^<v^^>v><^<<<>><v>^><>^<vv>^^<^<v>^v^v^vv<^>>v<^^^><<^><vvv><^v><<<<<>vv<<
>^^v^v^<v^<<v^^^<vv<>v^<>><v>><vvv^^vv<^<><^^vv^^^<v<>^><v<<^v<<<>>>^><<<><<vv>^<><v^^<<<^<<^v<vv<^^^>><v^^>>><^><vv>vv>>^<v^>>^>v>>>v^>v^>^<v>>><v>><v<vv^v>vvv<>>^<<<>^^^^<<<>>>>vv<v<^><<>^v<v^<>>v^v^>^<^>v>><vv^>v><v<<^v>^^v>v<v<<<^^<<>>v>^<^^<<>>^^<^<v>^>vvvv<v^>>vv^<^>^<>><<<<^v><vv<vv<v^><^<>>^>v>v>>><v<>v^<^<^>^<><^>>^^v^vv<>vv><^v<>><<><^<vvvv><^v^^v>>>v<<v<v^>^<>^<<><v<^<<<^<><<>>><^^^v^>>v>><<vv^^^<<^<>v>^^^v<<v><<<^>v^>^v<^v<<<>vv^^>>^>>vv<vv>^^<<v^><^<>v<^^v<v<v<v>>^>><<^<><>vv<v<v<>^>>>>v>v<<^^<<^vv>v<>v<><<<><^^^<<>v>>^^v<>vv^^<vv>^>^>>><>>^<<>^^>>^vv>v>^v<^<^vvv>v<<v<vv^<><<v^^>v>v^vv<<vv^<<^><v<^>^v><v><v^<>v^><<^^<v^><>v<<v<<><>v>v>>>>><>^<>v>^^><<>vv<^<<>v^>v^>>>^><><<<><>vv^v^><v>^^^v^v>>^v^>^>^<>>^v>^<><vvv><<<^v>><vv>>v<>>^v<^>>^vv><>v>><^^>v<<<v<<<vv>v>v<>^v^<<<vv^<^^v<^<vvvv<v<^<^><vv<>vv^>^v^<>>v<v>><>>><^^^><>vv<<<^^v>^>^v<vv^^v><v<<>>v>vvv<><^^>^>^<<vvvv<v><v^><>v^>v>vv<v<><vv>^<v<^v<vvvvv>^^<^^^<v>^vv^><<v>^vv>^>>^^^v<><>vvv<>>vv^<><><vv<^<>v><>v>^>^<v<<>>v>>^'''


# board = """####################
# ##....[]....[]..[]##
# ##............[]..##
# ##..[][]....[]..[]##
# ##....[]@.....[]..##
# ##[]##....[]......##
# ##[]....[]....[]..##
# ##..[][]..[]..[][]##
# ##........[]......##
# ####################"""
# commands = """<vv>^<v^>v>^vv^v>v<>v^v<v<^vv<<<^><<><>>v<vvv<>^v^>^<<<><<v<<<v^vv^v>^
# vvv<<^>^v^^><<>>><>^<<><^vv^^<>vvv<>><^^v>^>vv<>v<<<<v<^v>^<^^>>>^<v<v
# ><>vv>v^v^<>><>>>><^^>vv>v<^^^>>v^v^<^^>v^^>v^<^v>v<>>v^v^<v>v^^<^^vv<
# <<v<^>>^^^^>>>v^<>vvv^><v<<<>^^^vv^<vvv>^>v<^^^^v<>^>vvvv><>>v^<<^^^^^
# ^><^><>>><>^^<<^^v>>><^<v>^<vv>>v>>>^v><>^v><<<<v>>v<v<v>vvv>^<><<>^><
# ^>><>^v<><^vvv<^^<><v<<<<<><^v<<<><<<^^<v<^^^><^>>^<v^><<<^>>^v<v^v<v^
# >^>>^v>vv>^<<^v<>><<><<v<<v><>v<^vv<<<>^^v^>^^>>><<^v>>v^v><^^>>^<>vv^
# <><^^>^^^<><vvvvv^v<v<<>^v<v>v<<^><<><<><<<^^<<<^<<>><<><^^^>^^<>^>v<>
# ^^>vv<^v^v<vv>^<><v<^v>^^^>>>^^vvv^>vvv<>>>^<^>>>>>^<<^v>^vvv<>^<><<v>
# v^^>>><<^^<>>^v^<v^vv<>v^<<>^<^v^v><^<<<><<^<v><v<>vv>>v><v^<vv<>v^<<^"""
lines = board.splitlines()
height = len(lines)
width = len(lines[0])
loc = ([line.find("@") for line in lines if line.find("@") != -1][0],
       [idx for idx, line in enumerate(lines) if "@" in line][0]
)
board = [[ch for ch in line] for line in lines]

f = open("src/day15/moves.txt", "w")

for idx, c in enumerate(commands.replace("\n", "")):
    next = [[ch for ch in line] for line in board]
    dir = (0, 0)
    match c:
        case "v":
            dir = (0, 1)
        case "<":
            dir = (-1, 0)
        case ">":
            dir = (1, 0)
        case "^":
            dir = (0, -1)
        case _:
            continue
    def update(moves):
        size = 0
        while len(moves) != size:
            size = len(moves)
            for (x, y), _ in moves.copy().items():
                match board[y + dir[1]][x + dir[0]]:
                    case ".":
                        pass
                    case "#":
                        moves = {}
                        size = 0
                        break
                    case "[":
                        moves[(x + dir[0], y + dir[1])] = board[y + dir[1]][x + dir[0]]
                        moves[(x + dir[0] + 1, y + dir[1])] = board[y + dir[1]][x + dir[0] + 1]
                    case "]":
                        moves[(x + dir[0], y + dir[1])] = board[y + dir[1]][x + dir[0]]
                        moves[(x + dir[0] - 1, y + dir[1])] = board[y + dir[1]][x + dir[0] - 1]
        if moves == {}: return False
        for (x, y), _ in moves.items():
            next[y][x] = '.'
        for (x, y), v in moves.items():
            if v == '@': f.write(f"{idx} = {v} {dir} {(x, y)}\n")
            if v == '[': f.write(f"{idx} = {v} with {x}, {y}\n")
            next[y + dir[1]][x + dir[0]] = v
        return True
    
    # if idx == 56:
    #     print(c)
    #     print(dir)
    #     print(board[loc[1] + dir[1]][loc[0] + dir[0]])
    #     break
    match board[loc[1] + dir[1]][loc[0] + dir[0]]:
        case ".":
            next[loc[1] + dir[1]][loc[0] + dir[0]] = "@"
            f.write(f"{idx} = @ {dir} {(loc[0], loc[1])}\n")
            next[loc[1]][loc[0]] = "."

            loc = (loc[0] + dir[0], loc[1] + dir[1])
        case "[":
            moves = {loc: board[loc[1]][loc[0]],
                     (loc[0] + dir[0], loc[1] + dir[1]): board[loc[1] + dir[1]][loc[0] + dir[0]],
                     (loc[0] + dir[0] + 1, loc[1] + dir[1]): board[loc[1] + dir[1]][loc[0] + dir[0] + 1],
            }
            if update(moves):
                loc = (loc[0] + dir[0], loc[1] + dir[1])
        case "]":
            moves = {loc: board[loc[1]][loc[0]],
                     (loc[0] + dir[0], loc[1] + dir[1]): board[loc[1] + dir[1]][loc[0] + dir[0]],
                     (loc[0] + dir[0] - 1, loc[1] + dir[1]): board[loc[1] + dir[1]][loc[0] + dir[0] - 1],
            }
            if update(moves):
                loc = (loc[0] + dir[0], loc[1] + dir[1])
        case "#":
            pass
    board = next

print("\n".join("".join(ch for ch in l) for l in board))
# print([(x, y) for y, r in enumerate(board) for x, c in enumerate(r) if c == '['])
print(sum(x + y * 100 for (x, y) in [(x, y) for y, r in enumerate(board) for x, c in enumerate(r) if c == '[']))